# ๐ฏ ุงูุฎุทูุงุช ุจุงูุชูุตูู ุงูููู

## ุงููุดููุฉ ุงููู ุนูุฏู ุฏูููุชู:
```
ููุง ุชุบูุฑ ุจูุงูุงุช ุทุงูุจ โ ุงูุฅุดุนุงุฑ ูุธูุฑ ุฌูุง ุงูุชุทุจูู โ
ููู ูู ุงูุชุทุจูู ูุบูู โ ูููุด ุฅุดุนุงุฑ โ
```

## ููู ุงููุดููุฉ ุฏูุ
Flutter ุจูุถูู ุงูุฅุดุนุงุฑ ูู Firestore ูู collection ุงุณูู `fcm_queue`  
ููู **ูููุด ุญุฏ ุจููุฑุฃ ููู ููุจุนุช ุงูุฅุดุนุงุฑ ุงูุญูููู ุนุจุฑ FCM**

---

## ๐ง ุงูุญู (ุฎุทูุฉ ุจุฎุทูุฉ):

### ุงูุฎุทูุฉ 1: ุฌูุจ Service Account Key ูู Firebase

**ุดุฑุญ ุจุงูุตูุฑ:**

1. **ุงูุชุญ Firebase Console**
   - ุฑูุญ ุนูู: https://console.firebase.google.com
   - ุงุฎุชุงุฑ ุงููุดุฑูุน ุจุชุงุนู: **mybus-5a992**

2. **ุงุถุบุท ุนูู ุงูุชุฑุณ (โ๏ธ)**
   - ูู ุงูู Sidebar ุงูุดูุงู
   - ุงุฎุชุงุฑ **Project settings**

3. **ุฑูุญ ูุชุงุจ Service accounts**
   - ูุชูุงูู ุตูุฑุฉ Node.js
   - ูุชุญุชูุง ุฒุฑุงุฑ **Generate new private key**

4. **ุงุถุบุท Generate key**
   - ููุทูุน popup ุชุญุฐูุฑ
   - ุงุถุบุท **Generate key** ุชุงูู

5. **ุงูููู ูุฒู!**
   - ููู JSON ูุฒู ุนูู ุงูููุจููุชุฑ
   - ุงูุงุณู ุจุชุงุนู ุดุจู: `mybus-5a992-firebase-adminsdk-xxxxx.json`

6. **ุบูุฑ ุงูุงุณู**
   - ุบูุฑ ุงูุงุณู ูู: **`serviceAccountKey.json`**
   - (ุจุงูุธุจุท ูุฏูุ ุญุฑู ูุจูุฑ S)

7. **ุญุท ุงูููู ูู ูุฌูุฏ backend**
   ```
   C:\Users\musta\Desktop\pro\mybus\backend\serviceAccountKey.json
   ```

---

### ุงูุฎุทูุฉ 2: ุดุบู ุงูู Backend

**ุงูุทุฑููุฉ ุงูุฃุณูู:**

1. ุงูุชุญ ูุฌูุฏ backend:
   ```
   C:\Users\musta\Desktop\pro\mybus\backend
   ```

2. ุฏูุณ double-click ุนูู ููู **`start.bat`**

3. ูููุชุญ Console ููุจุฏุฃ ูุดุชุบู

**ุฃู ูู Command Prompt:**

1. ุงุถุบุท `Win + R`
2. ุงูุชุจ: `cmd`
3. ุงุถุบุท Enter
4. ุงูุชุจ:
   ```cmd
   cd C:\Users\musta\Desktop\pro\mybus\backend
   start.bat
   ```

---

### ุงูุฎุทูุฉ 3: ุชุฃูุฏ ุฅูู ุดุบุงู

**ูุชุดูู ูุฏู ูู ุงูู Console:**

```
================================
 ๐ MyBus Backend Service
================================

โ Node.js version:
v20.11.0

โ serviceAccountKey.json ููุฌูุฏ

๐ฆ ุชุซุจูุช Dependencies...
โ ุชู ุชุซุจูุช Dependencies ุจูุฌุงุญ

================================
 ๐ฅ ุจุฏุก ุชุดุบูู ุงูุฎุฏูุฉ...
================================

๐ MyBus Notification Service Started!
๐ก Listening to Firestore changes...

โ ุฌููุน ุงููุฑุงูุจุงุช ูุดุทุฉ:
   - fcm_queue (ุงูุฃูู ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช)
   - trips (ุฑุญูุงุช ุงูุทูุงุจ)
   - absences (ุทูุจุงุช ุงูุบูุงุจ)
   - complaints (ุงูุดูุงูู)

๐ Service is running... 5/10/2025, 10:30:00 ู
```

**ูู ุดูุช ุงูููุงู ุฏู โ Backend ุดุบุงู ุจูุฌุงุญ! โ**

---

### ุงูุฎุทูุฉ 4: ุฌุฑุจ ุงูุฅุดุนุงุฑุงุช

1. **ุฎูู ุงูู Backend ุดุบุงู** (ูุชูููุด ุงูู Console)

2. **ุงูุชุญ ุงูุชุทุจูู**

3. **ุบูุฑ ุจูุงูุงุช ุทุงูุจ**:
   - ูุซูุงู: ุบูุฑ ุงูุงุณู ุฃู ุงููุฏุฑุณุฉ

4. **ุดูู ุงูู Console ุจุชุงุน ุงูู Backend**:
   ```
   ๐ค ูุนุงูุฌุฉ ุฅุดุนุงุฑ ุฌุฏูุฏ ูู ุงููุงุฆูุฉ: abc123
      ุงููุณุชูู: parent_user_id
      ุงูุนููุงู: ุชู ุชุญุฏูุซ ุจูุงูุงุช ุงูุทุงูุจ
      โ ุฅุดุนุงุฑ ูุฑุณู ุจูุฌุงุญ
   ```

5. **ุดูู ุงูููุจุงูู/notification bar**:
   - ุงูุฅุดุนุงุฑ ููุธูุฑ ุจุฑู ุงูุชุทุจูู! ๐

---

## ๐ ููู ุชุนุฑู ุฅู ุงูุฅุดุนุงุฑ ุฑุงุญ ุจุฑูุ

### ูุจู ุชุดุบูู Backend:
- ุงูุฅุดุนุงุฑ ูุธูุฑ **ุฏุงุฎู ุงูุชุทุจูู** ุจุณ โ
- ูู ูููุช ุงูุชุทุจููุ ูููุด ุฅุดุนุงุฑ โ

### ุจุนุฏ ุชุดุบูู Backend:
- ุงูุฅุดุนุงุฑ ูุธูุฑ **ุฏุงุฎู ุงูุชุทุจูู** โ
- ุงูุฅุดุนุงุฑ ูุธูุฑ **ูู notification bar** โ
- ุญุชู ูู ุงูุชุทุจูู ูุบููุ ุงูุฅุดุนุงุฑ ูููุตู โ

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ:

### 1. Backend ูุงุฒู ููุถู ุดุบุงู
- ูู ูููุช ุงูู Console โ ุงูุฅุดุนุงุฑุงุช ูุด ูุชุฑูุญ ุจุฑู
- **ุงูุญู:** ุงุฑูุน ุงูู Backend ุนูู ุณูุฑูุฑ (ุดุฑุญ ูู ุงูุฃุณูู)

### 2. ุฃูู ูุฑุฉ ุจุณ
- ุฃูู ูุฑุฉ ููุงุฎุฏ ููุช ูุญูู Dependencies
- ุจุนุฏ ูุฏู ููุจูู ุณุฑูุน

### 3. ููุงุณุชุฎุฏุงู ุงูุญูููู
- ูุงุฒู ุชุฑูุน ุงูู Backend ุนูู ุณูุฑูุฑ ุฒู Railway
- ุนุดุงู ููุถู ุดุบุงู 24/7

---

## ๐ ุฑูุน Backend ุนูู Railway (ุงุฎุชูุงุฑู ููุฅูุชุงุฌ)

### ููู ูุญุชุงุฌ Railwayุ
- Backend ุนูู ุงูููุจููุชุฑ โ ุจูุดุชุบู ููุง ุงูููุจููุชุฑ ุดุบุงู ุจุณ
- Backend ุนูู Railway โ ุดุบุงู 24/7 ููุด ูุญุชุงุฌ ุชููู ุงูููุจููุชุฑ

### ุงูุฎุทูุงุช:

1. **ุงุนูู ุญุณุงุจ ุนูู Railway**
   - ุฑูุญ https://railway.app
   - ุงุนูู ุญุณุงุจ ุจุงูู GitHub

2. **New Project**
   - ุงุถุบุท "New Project"
   - ุงุฎุชุงุฑ "Deploy from GitHub repo"
   - ูู ูููุด reposุ ุงุนูู connect ูู GitHub ุงูุฃูู

3. **ุงุฎุชุงุฑ Repository**
   - ุงุฎุชุงุฑ ุงูู repo ุจุชุงุน ุงููุดุฑูุน
   - ูู ูุด ููุฌูุฏุ ุงุฑูุน ุงููุดุฑูุน ุนูู GitHub ุงูุฃูู

4. **Settings**
   - Root Directory: ุงูุชุจ `backend`
   - ุนุดุงู ูุนุฑู ุฅู ุงูู backend ูู ุงููุฌูุฏ ุฏู

5. **Add Variables**
   - ุงุถุบุท ุนูู "Variables"
   - ุฃุถู ูุชุบูุฑูู:

   **ูุชุบูุฑ 1:**
   - Name: `FIREBASE_DATABASE_URL`
   - Value: `https://mybus-5a992.firebaseio.com`

   **ูุชุบูุฑ 2:**
   - Name: `SERVICE_ACCOUNT_KEY`
   - Value: ุงูุชุญ ููู `serviceAccountKey.json` ูุงูุณุฎ ูู ูุญุชูุงู (JSON ูุงูู)

6. **Deploy!**
   - ุงุถุบุท Deploy
   - ุงุณุชูู 2-3 ุฏูุงูู
   - ุงูุจุฑูุงูุฌ ููุจูู ุดุบุงู ุนูู Railway 24/7

7. **ุดูู ุงูู Logs**
   - ุงุถุบุท ุนูู Deployments
   - ูุชุดูู ููุณ ุงูุฑุณุงุฆู ุงููู ุดูุชูุง ุนูู ุงูููุจููุชุฑ
   - ูู ุดูุช "Service is running" โ ุชูุงู! โ

---

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ:

### 1. "Node.js ุบูุฑ ูุซุจุช"
**ุงูุญู:**
- ุญูู Node.js ูู: https://nodejs.org
- ุงุฎุชุงุฑ ุงููุณุฎุฉ LTS (ุงูููุตู ุจูุง)
- ูุตุจ ุนุงุฏู Next โ Next
- ุงูุชุญ Command Prompt ุฌุฏูุฏ ูุฌุฑุจ ุชุงูู

### 2. "serviceAccountKey.json ุบูุฑ ููุฌูุฏ"
**ุงูุญู:**
- ุฑุงุฌุน ุงูุฎุทูุฉ 1 ููู
- ุชุฃูุฏ ุฅู ุงูุงุณู ุจุงูุธุจุท: `serviceAccountKey.json`
- ุชุฃูุฏ ุฅูู ูู ูุฌูุฏ `backend` ูุด ูู ูุฌูุฏ ุชุงูู

### 3. "Error: Permission denied"
**ุงูุญู:**
- ุดุบู Command Prompt as Administrator
- ุฃู ุดุบู ุงูู bat file as Administrator

### 4. "Cannot find module"
**ุงูุญู:**
```cmd
cd backend
npm install
node index.js
```

### 5. ุงูุฅุดุนุงุฑุงุช ูุณู ูุด ุฑุงุญุฉ ุจุฑู
**ุงูุญู:**
1. ุชุฃูุฏ ุฅู ุงูู Backend ุดุบุงู (ุดูู ุงูู Console)
2. ุดูู Firebase Console โ Firestore โ fcm_queue
3. ูู ููู ุฅุดุนุงุฑุงุช status ุจุชุงุนูุง "pending" โ Backend ูุด ุดุบุงู
4. ูู status ุจุชุงุนูุง "sent" โ Backend ุดุบุงู โ
5. ุชุฃูุฏ ุฅู FCM Token ูุญููุธ ูู users collection
6. ุฎูู ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู ูุฑุฉ ุชุงููุฉ

---

## โ ุงุฎุชุจุงุฑ ููุงุฆู:

### ุฌุฑุจ ุงูุฎุทูุงุช ุฏู:

1. โ ุดุบู Backend (start.bat)
2. โ ุดูู ุฑุณุงูุฉ "Service is running"
3. โ ุงูุชุญ ุงูุชุทุจูู
4. โ ุบูุฑ ุจูุงูุงุช ุทุงูุจ
5. โ ุดูู Console โ ูุชุดูู "ุฅุดุนุงุฑ ูุฑุณู ุจูุฌุงุญ"
6. โ **ููู ุงูุชุทุจูู ุชูุงูุงู**
7. โ ุบูุฑ ุจูุงูุงุช ุทุงูุจ ูุฑุฉ ุชุงููุฉ ูู user ุชุงูู
8. โ **ุงูุฅุดุนุงุฑ ูุงุฒู ูุธูุฑ ูู notification bar ุญุชู ูู ุงูุชุทุจูู ูุบูู**

ูู ูู ุงูุฎุทูุงุช ูุฌุญุช โ Backend ุดุบุงู 100%! ๐

---

## ๐ ูุญุชุงุฌ ูุณุงุนุฏุฉุ

ูู ูุณู ุนูุฏู ูุดููุฉ:
1. ุฎุฏ screenshot ูู ุงูู Console
2. ุฎุฏ screenshot ูู ุงูุฎุทุฃ
3. ุงุจุนุชูู ูุฃูุง ุฃุณุงุนุฏู

**ููุญูุธุฉ:** ูุชูููุด ุงูู Console ูู ุนุงูุฒ ุงูุฅุดุนุงุฑุงุช ุชูุถู ุชุดุชุบู!
