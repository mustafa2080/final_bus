# โ ุฅุตูุงุญ ุตูุญุฉ ุชุชุจุน ุงูุจุงุต - bus_tracking_screen.dart

## ๐ง ุงููุดุงูู ุงูุชู ุชู ุฅุตูุงุญูุง

### 1๏ธโฃ ูุดููุฉ "ูุง ููุฌุฏ ุทูุงุจ"

**ุงููุดููุฉ ุงููุฏููุฉ:**
```dart
// ูุงู ูุฌูุจ ููุท ุทูุงุจ ููู ุงูุฃูุฑ ุงูุญุงูู
.where('parentId', isEqualTo: currentUser.uid)
```

**ุงูุญู ุงูุฌุฏูุฏ:**
```dart
// ุงูุขู ูุฌูุจ ูู ุงูุทูุงุจ ูู ุงูุจุงุต
.where('busId', isEqualTo: _busId)
```

**ุงููุชูุฌุฉ:**
- โ ูุนุฑุถ **ุฌููุน ุงูุทูุงุจ** ูู ุงูุจุงุต
- โ ูููุฒ ุทูุงุจ ููู ุงูุฃูุฑ ุงูุญุงูู ุจู badge "ุงุจูู/ุงุจูุชู"
- โ ุฅุทุงุฑ ุฃุฒุฑู ุญูู ุงุณู ุงุจู/ุงุจูุฉ ููู ุงูุฃูุฑ

---

### 2๏ธโฃ ูุดููุฉ ุงูุณุฑุนุฉ ุงูุซุงุจุชุฉ

**ุงููุดููุฉ ุงููุฏููุฉ:**
```dart
// ูุงู ูุชุฌุงูู ุงูุณุฑุนุฉ ุฅุฐุง ูุงูุช null ุฃู 0
final speed = (data['speed'] as num?)?.toDouble() ?? 0.0;
```

**ุงูุญู ุงูุฌุฏูุฏ:**
```dart
// ุงูุขู ูุฌูุจ ุงูุณุฑุนุฉ ุจุดูู ุตุญูุญ ููุทุจุน logs ููุชุญูู
double speed = 0.0;
if (data['speed'] != null) {
  speed = (data['speed'] as num).toDouble();
  debugPrint('๐ Speed received: $speed km/h');
}
```

**ุงููุชูุฌุฉ:**
- โ ุงูุณุฑุนุฉ ุชุชุญุฏุซ ูู **ุงูููุช ุงููุนูู**
- โ ุชุธูุฑ ุจุงููููููุชุฑ/ุณุงุนุฉ (km/h)
- โ ุนูุฏ ุงูุณููู ุชุธูุฑ 0.0 km/h

---

### 3๏ธโฃ ุฏุนู ุงูููุจ ูุงูููุจุงูู

**ุชู ุฅุถุงูุฉ:**
```dart
// ูุชููู ุชููุงุฆูุงู ูุน ุงูููุตุฉ
String serverUrl;
if (kIsWeb) {
  serverUrl = 'http://localhost:3000';  // ููููุจ
} else {
  serverUrl = 'http://192.168.2.2:3000'; // ููููุจุงูู
}
```

---

## ๐จ ุงูุชุญุณููุงุช ุงูุฅุถุงููุฉ

### ูุงุฆูุฉ ุงูุทูุงุจ ุงููุญุณููุฉ

ุงูุขู ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ๐ฅ ุณุชุธูุฑ:

1. **ุฌููุน ุงูุทูุงุจ ูู ุงูุจุงุต** (ููุณ ููุท ุฃุทูุงู ููู ุงูุฃูุฑ)
2. **ุชูููุฒ ุจุตุฑู** ูุฃุทูุงู ููู ุงูุฃูุฑ:
   - โ ุฅุทุงุฑ ุฃุฒุฑู ุญูู ุงูุจุทุงูุฉ
   - โ Badge ูููู "ุงุจูู/ุงุจูุชู"
   - โ Avatar ุจุงูููู ุงูุฃุฒุฑู ุงููุงูู
   - โ ุงุณู ุจุงูููู ุงูุฃุฒุฑู

3. **ุงูุทูุงุจ ุงูุขุฎุฑูู**:
   - โ ุจุทุงูุฉ ุนุงุฏูุฉ ุจุฏูู ุฅุทุงุฑ
   - โ Avatar ุดูุงู
   - โ ุนูุงูุฉ ุฎุถุฑุงุก โ

---

## ๐ ูุนูููุงุช ุงูุณุฑุนุฉ

### ููู ุชุนูู ุงูุณุฑุนุฉุ

1. **ุงููุดุฑู ูุจุฏุฃ ุงูุชุชุจุน** ูู ุชุทุจูู ุงููุดุฑู
2. **ุงููุงุชู ูุฑุณู ุงููููุน + ุงูุณุฑุนุฉ** ูู ุซูุงูู
3. **Backend ูุณุชูุจู ููุจุซ** ุงูุณุฑุนุฉ ููู ุฃูููุงุก ุงูุฃููุฑ
4. **ุชุทุจูู ููู ุงูุฃูุฑ ูุนุฑุถ** ุงูุณุฑุนุฉ ุงูุญุงููุฉ

### ูุซุงู:
```
๐ ุงูุณุฑุนุฉ
   40.5 ูู/ุณ
```

- **0 ูู/ุณ** = ุงูุจุงุต ูุงูู
- **20-40 ูู/ุณ** = ุณุฑุนุฉ ุนุงุฏูุฉ ูู ุงููุฏููุฉ
- **60+ ูู/ุณ** = ุณุฑุนุฉ ุนูู ุงูุทุฑูู ุงูุณุฑูุน

---

## ๐งช ููู ุชุฎุชุจุฑุ

### ุงุฎุชุจุงุฑ ุงูุทูุงุจ:

1. ุงูุชุญ ุชุทุจูู ููู ุงูุฃูุฑ
2. ุงุฐูุจ ูุตูุญุฉ "ุชุชุจุน ุงูุจุงุต"
3. ุงุถุบุท ุนูู ุฒุฑ ๐ฅ (ุฃุนูู ุงููุณุงุฑ)
4. ูุฌุจ ุฃู ุชุฑู:
   - โ **ูู ุงูุทูุงุจ** ูู ุงูุจุงุต
   - โ ุฃุทูุงูู **ูููุฒูู** ุจุงูุฃุฒุฑู

### ุงุฎุชุจุงุฑ ุงูุณุฑุนุฉ:

1. **ุงููุดุฑู**: ุดุบูู ุงูุชุชุจุน ูู ุชุทุจูู ุงููุดุฑู
2. **ุงููุดุฑู**: ุชุญุฑู ุจุงููุงุชู (ุฃู ุณูุงุฑุฉ)
3. **ููู ุงูุฃูุฑ**: ุดุงูุฏ ุงูุณุฑุนุฉ ุชุชุญุฏุซ ูู ุงูููุช ุงููุนูู

### ูุซุงู Logs:

```
๐ Processing location update: {...}
๐ Speed received: 35.2 km/h
โ State updated - Speed: 35.2 km/h, Location: (24.7136, 46.6753)
```

---

## ๐ ุงูุชุญูู ูู ุงูุจูุงูุงุช

### ูู Console:

**ููุทูุงุจ:**
```
๐ Loading students for bus: bus123
๐ Found 5 students in this bus
๐ Student: ุฃุญูุฏ ูุญูุฏ, Grade: ุงูุตู ุงูุฃูู, Mine: true
๐ Student: ุณุงุฑุฉ ุนูู, Grade: ุงูุตู ุงูุซุงูู, Mine: false
...
โ ุชู ุฌูุจ 5 ุทุงูุจ ูู ุงูุจุงุต
```

**ููุณุฑุนุฉ:**
```
๐ Speed received: 42.3 km/h
โ State updated - Speed: 42.3 km/h
```

---

## โก ุงููุฑู ูุจู ูุจุนุฏ

| ุงูููุฒุฉ | ูุจู โ | ุจุนุฏ โ |
|--------|--------|--------|
| ุนุฏุฏ ุงูุทูุงุจ | ููุท ุฃุทูุงู ููู ุงูุฃูุฑ | **ูู ุทูุงุจ ุงูุจุงุต** |
| ุชูููุฒ ุงูุฃุทูุงู | ูุง ููุฌุฏ | **Badge + ุฅุทุงุฑ ุฃุฒุฑู** |
| ุงูุณุฑุนุฉ | ุซุงุจุชุฉ ุฃู ุฎุงุทุฆุฉ | **ุชุชุญุฏุซ ูุญุธูุงู** |
| ุฏุนู ุงูููุจ | ูุง ูุนูู | **ูุนูู ุชูุงูุงู** |
| Logs | ููููุฉ | **ููุตูุฉ ููุชุชุจุน** |

---

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

ุงูุขู ุตูุญุฉ ุชุชุจุน ุงูุจุงุต:

โ ุชุนุฑุถ **ุฌููุน ุงูุทูุงุจ** ูู ุงูุจุงุต
โ ุชููุฒ ุฃุทูุงู ููู ุงูุฃูุฑ ุงูุญุงูู
โ ุงูุณุฑุนุฉ **ุชุชุญุฏุซ ูุญุธูุงู**
โ ุชุนูู ุนูู **ุงูููุจ ูุงูููุจุงูู**
โ ูุนูููุงุช ุฏูููุฉ ูููุตูุฉ

---

## ๐ ุฅุฐุง ูุง ุฒุงูุช ููุงู ูุดููุฉ

### ุงูุทูุงุจ ูุง ูุธูุฑูู:

1. ุชุญูู ูู Console:
   ```
   ๐ Found X students in this bus
   ```

2. ุชุฃูุฏ ูู:
   - โ ุงูุทูุงุจ ููู `busId` ููุณ ุจุงุต ููู ุงูุฃูุฑ
   - โ `isActive = true`
   - โ Firebase Rules ุชุณูุญ ุจุงููุฑุงุกุฉ

### ุงูุณุฑุนุฉ ูุง ุชุชุญุฏุซ:

1. ุชุญูู ูู Console:
   ```
   ๐ Speed received: X km/h
   ```

2. ุชุฃูุฏ ูู:
   - โ ุงููุดุฑู ุจุฏุฃ ุงูุชุชุจุน
   - โ ุงููุงุชู ูุชุญุฑู (ููุณ ุณุงูู)
   - โ Socket.IO ูุชุตู

---

**ุฌุฑุจ ุงูุขู! ๐**
